package br.com.npsoftwares.djbc.dao;

import java.awt.List;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Calendar;

import br.com.npsoftwares.jdbc.ConnectionFactory;
import br.com.npsoftwares.jdbc.modelo.Contato;


public class ContatoDao {

	private Connection conn;
	
	public ContatoDao()
	{
		new ConnectionFactory();
		this.conn = ConnectionFactory.getConn();
	}
	
	public void addContato(Contato contato){
 
		 java.sql.Date dataForRecord = new java.sql.Date(Calendar.getInstance().getTimeInMillis());
		
	     StringBuilder sbQuery = new StringBuilder();
	     sbQuery.append("INSERT INTO tb0001_Contatos (");
	     sbQuery.append("nomeCONTATO,emailCONTATO,enderecoCONTATO,dataNascimentoCONTATO)");
	     sbQuery.append("values(?,?,?,?)");
	     
	     try {
			 
	    	 PreparedStatement stmt = conn.prepareStatement(sbQuery.toString());
	    	 
		     stmt.setString(1, contato.getNome());
		     stmt.setString(2,contato.getEmail());
		     stmt.setString(3,contato.getEndereco());
		     stmt.setDate(4,dataForRecord);
		     
		     stmt.execute();
		     stmt.close(); 
		     
		} catch (Exception e) {
			
			throw new RuntimeException(e);
		}

	}
	
	public List<Contato> getList()
	{
		try {
			List<Contato> contatos = new ArrayList<Contato>();
			PreparedStatement stmt = this.conn.prepareStatement("SELECT * FROM tb0001_Contatos");
			ResultSet rs  = stmt.executeQuery();
			
			while(rs.next()){
				
				Contato contato = new Contato(rs.getLong("idCONTATO"),rs.getString("nomeCONTATO"),rs.getString("emailCONTATO"),rs.getString("enderecoCONTATO"),new Calendar().getInstance());
			}
			
		} catch (Exception e) {
			// TODO: handle exception
		}
		
	}
}
